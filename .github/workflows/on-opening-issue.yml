name: "On Opening Issue"
on:
  issues:
    types: [opened, reopened]
env:
  AIS_PROJECT_URL: ${{ secrets.AIS_PROJECT_URL }}
jobs:
  initalise-epic:
    if: startsWith(github.event.issue.title, '[EPIC]')
    uses: ./.github/workflows/create-issue-list.yml
    with:
      issuetype: Epic
  initalise-feature:
    if: startsWith(github.event.issue.title, '[FEATURE]')
    uses: ./.github/workflows/create-issue-list.yml
    with:
      issuetype: Feature
  # add-labels:
  #   if: ${{ always() }}
  #   needs: [initalise-epic, initalise-feature]
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: actions-ecosystem/action-add-labels@v1
  #       with:
  #         labels: |
  #           pipelines
  #           ${{ inputs.issuetype }}
  add-to-project:
    name: Add issue to project
    runs-on: ubuntu-latest
    steps:
      - name: Assign issues to the AIS project
        if: env.AIS_PROJECT_URL != ''
        uses: actions/add-to-project@v0.3.0
        with:
          project-url: ${{ secrets.AIS_PROJECT_URL }}
          github-token: ${{ secrets.AIS_ADMIN_KEY }}
