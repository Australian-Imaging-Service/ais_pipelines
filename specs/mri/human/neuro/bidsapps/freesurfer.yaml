pkg_version: &pkg_version "v6.0.1-6.1"
wrapper_version: "1.0"
authors:
  - thomas.close@sydney.edu.au
base_image: !join ["bids/freesurfer:", *pkg_version]
info_url: "https://www.freesurfer.net/"
package_manager: apt
system_packages:
python_packages: # Copy in local copies of pydra and pydra-dcm2niix
  - name: pydra
  - name: pydra-dcm2niix
package_templates:
  - name: dcm2niix
    version: v1.0.20201102
licenses:
  - source: freesurfer.txt
    destination: /opt/freesurfer/license.txt
commands:
  - name: freesurfer
    version: 1a1
    pydra_task: arcana.tasks.bids:bids_app
    description: "freesurfer: An open source neuroimaging toolkit for processing, analyzing, and visualizing human brain MR images"
    long_description: >-
      `freesurfer` is a FreeSurfer is an open source package for the analysis and visualization of structural,
       functional, and diffusion neuroimaging data from cross-sectional and longitudinal studies. 
       It is developed by the Laboratory for Computational Neuroimaging at the Athinoula A. Martinos Center 
       for Biomedical Imaging.
    inputs: &inputs
      - name: T1w
        path: anat/T1w
        format: medimage:NiftiGzX
        stored_format: medimage:Dicom
        description: "T1-weighted anatomical scan"
      - name: T2w
        path: anat/T2w
        format: medimage:NiftiGzX
        stored_format: medimage:Dicom
        description: "T2-weighted anatomical scan"
    outputs: &outputs
      - name: freesurfer
        format: common:Directory
    parameters:
      - name: freesurfer_flags
        pydra_field: flags
        type: string
      - name: json_edits
        pydra_field: json_edits
        type: string
    row_frequency: session
    configuration:
      name: fmriprep
      inputs: *inputs
      outputs: *outputs
      executable: /opt/conda/bin/freesurfer
      dataset: /work/bids-dataset
      app_output_dir: /work/bids-app-output
# Parameters (see https://fmriprep.org/en/latest/usage.html)
# ----------------------------------------------------------

# [-t TASK_ID] [--echo-idx ECHO_IDX] [--bids-filter-file FILE]
# [--anat-derivatives PATH] [--bids-database-dir PATH]
# [--nprocs NPROCS] [--omp-nthreads OMP_NTHREADS]
# [--mem MEMORY_MB] [--low-mem] [--use-plugin FILE]
# [--anat-only] [--boilerplate_only] [--md-only-boilerplate]
# [--error-on-aroma-warnings] [-v]
# [--ignore {fieldmaps,slicetiming,sbref,t2w,flair} [{fieldmaps,slicetiming,sbref,t2w,flair} ...]]
# [--longitudinal]
# [--output-spaces [OUTPUT_SPACES [OUTPUT_SPACES ...]]]
# [--me-output-echos] [--bold2t1w-init {register,header}]
# [--bold2t1w-dof {6,9,12}] [--force-bbr] [--force-no-bbr]
# [--medial-surface-nan] [--slice-time-ref SLICE_TIME_REF]
# [--dummy-scans DUMMY_SCANS] [--random-seed _RANDOM_SEED]
# [--use-aroma]
# [--aroma-melodic-dimensionality AROMA_MELODIC_DIM]
# [--return-all-components]
# [--fd-spike-threshold REGRESSORS_FD_TH]
# [--dvars-spike-threshold REGRESSORS_DVARS_TH]
# [--skull-strip-template SKULL_STRIP_TEMPLATE]
# [--skull-strip-fixed-seed]
# [--skull-strip-t1w {auto,skip,force}] [--fmap-bspline]
# [--fmap-no-demean] [--topup-max-vols TOPUP_MAX_VOLS]
# [--use-syn-sdc [{warn,error}]] [--force-syn]
# [--fs-license-file FILE] [--fs-subjects-dir PATH]
# [--no-submm-recon] [--cifti-output [{91k,170k}] |
# --fs-no-reconall] [--output-layout {bids,legacy}]
# [-w WORK_DIR] [--clean-workdir] [--resource-monitor]
# [--reports-only] [--config-file FILE] [--write-graph]
# [--stop-on-first-crash] [--notrack]
# [--debug {compcor,fieldmaps,all} [{compcor,fieldmaps,all} ...]]
# [--sloppy]
